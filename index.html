<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>StarShopList: Free, Easy-to-Use Online Shopping List Maker</title>

<meta name="description" content="Create and manage your shopping list easily with StarShopList. A free, simple online tool for grocery and item tracking with export and share features.">
<meta name="keywords" content="shopping list, grocery list, online list maker, free shopping list, star shop list, item tracker, list app, mobile-friendly shopping list">

<meta property="og:title" content="StarShopList: Free Online Shopping List">
<meta property="og:description" content="Create, manage, export, and share your shopping list with ease. Simple, fast, and mobile-friendly!">
<meta property="og:type" content="website">
<meta property="og:url" content="[YOUR_WEBSITE_URL_HERE]"> 
<meta property="og:image" content="[YOUR_IMAGE_URL_HERE]"> 

<style>
  :root {
    --primary: #007bff;
    --success: #28a745;
    --warning: #ff9800;
    --danger: #f44336;
    --light-bg: #e6f7e6; 
    --dark-text: #333;
    --light-text: #fff;
    --border-radius: 8px;
    --transition: all 0.3s ease;
  }

  * {
    box-sizing: border-box;
  }

  body { 
    font-family: Arial, sans-serif; 
    background: var(--light-bg); 
    margin: 0; 
    padding: 0;
    color: var(--dark-text);
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }
  
  .main-content {
      padding: 10px;
      flex: 1; 
      padding-bottom: 70px; /* Space for fixed footer */
  }

  /* 1) Humburger Menu Styles */
  .navbar {
    background: var(--primary);
    color: var(--light-text);
    padding: 12px 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    position: sticky;
    top: 0;
    z-index: 1000;
  }

  .nav-title {
    font-size: 22px; 
    font-weight: bold;
  }

  .hamburger-menu {
    cursor: pointer;
    padding: 5px;
  }

  .hamburger-menu div {
    width: 25px;
    height: 3px;
    background-color: var(--light-text);
    margin: 5px 0;
    transition: var(--transition);
  }

  .nav-links {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    background-color: #f8f9fa; 
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    z-index: 999;
    padding: 10px 0;
  }

  .nav-links.open {
    display: block;
  }

  .nav-links a {
    color: var(--dark-text);
    padding: 10px 20px;
    text-decoration: none;
    display: block;
    border-bottom: 1px solid #eee;
    transition: background-color 0.2s;
  }

  .nav-links a:hover {
    background-color: #e9ecef;
  }

  /* 2) Footer Styles - Fixed at Bottom */
  .footer {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background: #333;
    color: var(--light-text);
    text-align: center;
    padding: 10px 0;
    box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
    z-index: 998;
  }

  .footer-links a {
    color: #ffc107; 
    margin: 0 10px;
    text-decoration: none;
    font-size: 14px;
    transition: color 0.2s;
  }

  .footer-links a:hover {
    color: var(--light-text);
  }

  /* 3) Input Section Styles */
  .input-section { 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    margin-top: 20px;
  }

  .item-box {
    width: 85%; 
    padding: 10px 14px; /* Padding adjusted */
    border-radius: var(--border-radius); 
    border: 1px solid #aaa;
    font-size: 17px; 
    margin-bottom: 8px; /* Margin reduced */
    transition: var(--transition);
  }

  .item-box:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
  }
  
  /* Qty/Rate/Add Button Layout Fix & Size Adjustments */
  .qty-rate-add-container {
    display: flex; 
    gap: 8px; /* Reduced gap */
    width: 85%;
    align-items: center; 
  }

  .qty-rate-container {
    display: flex;
    gap: 8px; /* Reduced gap */
    flex-grow: 1; 
  }

  .round-box {
    flex: 1; /* Ensures equal width */
    padding: 6px; /* Padding reduced for smaller size */
    text-align: center;
    border-radius: 12px; 
    border: 1px solid #aaa; 
    font-size: 14px; /* Font size reduced */
    transition: var(--transition);
  }

  .round-box:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
  }

  .add-btn {
    width: 40px; /* Smaller button */
    height: 40px; 
    min-width: 40px; 
    border-radius: 50%; 
    font-size: 18px;
    background: var(--primary); 
    color: var(--light-text); 
    border: none; 
    cursor: pointer;
    transition: var(--transition);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    padding: 0;
  }

  .add-btn:hover {
    background: #0056b3;
    transform: scale(1.05);
  }

  table { 
    width: 100%; 
    border-collapse: collapse; 
    background: white; 
    margin-top: 10px; 
    font-size: 16px; 
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    border-radius: var(--border-radius);
    overflow: hidden;
  }

  th, td { 
    border: 1px solid #ddd; 
    padding: 8px; 
    text-align: center; 
    transition: var(--transition);
  }

  /* Table column width adjustments for better look on small screens */
  #listTable th:nth-child(1), #listTable td:nth-child(1) { width: 5%; } 
  #listTable th:nth-child(2), #listTable td:nth-child(2) { text-align: left; width: 40%; white-space: normal; } /* Item Name */
  #listTable th:nth-child(3), #listTable td:nth-child(3) { width: 10%; } /* Qty */
  #listTable th:nth-child(4), #listTable td:nth-child(4) { width: 10%; } /* Rate */
  #listTable th:nth-child(5), #listTable td:nth-child(5) { width: 15%; } /* Amount */
  #listTable th:nth-child(6), #listTable td:nth-child(6) { width: 20%; } /* Action */


  th { 
    background: #333; 
    color: var(--light-text); 
  }

  tr:nth-child(even) {
    background-color: #f9f9f9;
  }

  tr:hover {
    background-color: #f1f1f1;
  }

  .btn-row { 
    text-align: center; 
    margin-top: 20px; 
  }

  .export { background: var(--success); }
  .export:hover { background: #218838; }

  .share { background: var(--warning); }
  .share:hover { background: #e68900; }

  .clear { background: var(--danger); }
  .clear:hover { background: #d32f2f; }

  .delete-btn {
    background: var(--danger);
    color: white;
    border: none;
    border-radius: 4px;
    padding: 5px 10px;
    cursor: pointer;
    transition: var(--transition);
  }

  /* Responsive adjustments for mobile screen fit */
  @media (max-width: 600px) {
    .qty-rate-add-container {
      width: 100%; /* Full width on small screens */
      padding: 0 10px;
      gap: 6px; /* Gap further reduced */
    }

    .item-box {
        width: 100%;
        padding: 10px;
    }
    
    .round-box {
      font-size: 14px;
      padding: 8px 4px; /* Horizontal padding reduced */
    }
    
    table {
      font-size: 14px;
    }
    
    th, td {
      padding: 6px 4px;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }
</style>
</head>
<body>

<div class="navbar">
  <div class="nav-title">StarShopList – <span id="todayDate"></span></div>
  <div class="hamburger-menu" onclick="toggleMenu()">
    <div></div>
    <div></div>
    <div></div>
  </div>
  <div class="nav-links" id="navLinks">
    <a href="#">Home</a>
    <a href="#">About Us</a>
    <a href="#">Contact</a>
  </div>
</div>

<div class="main-content">
<div class="input-section">
  <input type="text" id="item" class="item-box" placeholder="Enter Item Name">

  <div class="qty-rate-add-container">
    <div class="qty-rate-container">
        <input type="number" inputmode="decimal" id="qty" class="round-box" placeholder="Qty">
        <input type="number" inputmode="decimal" id="rate" class="round-box" placeholder="Rate">
    </div>
    <button class="add-btn" onclick="addItem()" aria-label="Add Item">+</button>
  </div>
</div>

<table id="listTable">
  <thead>
    <tr>
      <th>✔</th>
      <th>Item</th>
      <th>Qty</th>
      <th>Rate</th>
      <th>Amount</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<h3 style="text-align:center;">Total: ₹<span id="totalAmount">0.00</span></h3>

<div class="btn-row">
  <button class="export" onclick="exportCSV()">Export CSV</button>
  <button class="share" onclick="shareList()">Share</button>
  <button class="clear" onclick="clearAll()">Clear All</button>
</div>
</div> 

<div class="footer">
  <div class="footer-links">
    <a href="#">Privacy Policy</a>
    <a href="#">Terms of Use</a>
    <a href="#">Feedback</a>
  </div>
  <div style="font-size: 12px; margin-top: 5px;">&copy; <span id="currentYear"></span> StarShopList. All rights reserved.</div>
</div>


<script>
  // Security: Prevent XSS by sanitizing inputs
  function sanitizeInput(input) {
    const div = document.createElement('div');
    if (input.includes('<br>')) {
        return input;
    }
    div.textContent = input;
    return div.innerHTML;
  }

  document.getElementById("todayDate").innerText = new Date().toLocaleDateString();
  document.getElementById("currentYear").innerText = new Date().getFullYear();
  let list = JSON.parse(localStorage.getItem("shopList")) || [];

  // Toggle Hamburger Menu
  function toggleMenu() {
      document.getElementById("navLinks").classList.toggle("open");
  }

  // ENTER KEY = ADD ITEM
  document.getElementById("item").addEventListener("keydown", e => {
    if (e.key === "Enter") addItem();
  });
  
  document.getElementById("qty").addEventListener("keydown", e => {
    if (e.key === "Enter") addItem();
  });
  
  document.getElementById("rate").addEventListener("keydown", e => {
    if (e.key === "Enter") addItem();
  });

  function save() {
    localStorage.setItem("shopList", JSON.stringify(list));
    render();
  }

  function addItem() {
    const item = document.getElementById("item").value.trim();
    let qty = document.getElementById("qty").value.trim();
    let rate = document.getElementById("rate").value.trim();

    if (!item) {
      alert("Item name is required!");
      document.getElementById("item").focus();
      return;
    }

    if (qty && isNaN(parseFloat(qty))) {
      alert("Quantity must be a number!");
      document.getElementById("qty").focus();
      return;
    }
    
    if (rate && isNaN(parseFloat(rate))) {
      alert("Rate must be a number!");
      document.getElementById("rate").focus();
      return;
    }

    qty = qty || "-";  
    rate = rate || "-";

    list.push({ 
      item: sanitizeInput(item), 
      qty: sanitizeInput(qty), 
      rate: sanitizeInput(rate), 
      done: false 
    });
    
    document.getElementById("item").value = "";
    document.getElementById("qty").value = "";
    document.getElementById("rate").value = "";
    
    document.getElementById("item").focus();
    
    save();
    
    const rows = document.querySelectorAll("#listTable tbody tr");
    if (rows.length > 0) {
      rows[rows.length - 1].classList.add("pulse");
    }
  }

  function render() {
    let total = 0;
    const tbody = document.querySelector("#listTable tbody");
    tbody.innerHTML = "";

    if (list.length === 0) {
      const emptyRow = document.createElement("tr");
      emptyRow.innerHTML = `<td colspan="6" class="empty-state">Your shopping list is empty. Add some items!</td>`;
      tbody.appendChild(emptyRow);
    } else {
      list.forEach((data, i) => {
        const numQty = parseFloat(data.qty);
        const numRate = parseFloat(data.rate);
          
        let amount = (isNaN(numQty) || isNaN(numRate)) 
          ? "-" 
          : (numQty * numRate).toFixed(2);
          
        if (amount !== "-") total += parseFloat(amount);

        const row = document.createElement("tr");
        row.classList.add("fade-in");
        row.innerHTML = `
          <td><input type="checkbox" ${data.done ? "checked" : ""} onchange="toggle(${i})"></td>
          <td class="editable-cell" contenteditable="true" 
              onblur="updateItem(${i}, this.innerHTML, 'item')" 
              onclick="handleCellClick(this)"
              onfocus="handleCellFocus(this)" 
              ontouchstart="handleTouchStart(event)" 
              onkeydown="handleEditKeydown(event, ${i}, 'item')">${data.item}</td>
          <td class="editable-cell" contenteditable="true" 
              onblur="updateItem(${i}, this.innerHTML, 'qty')" 
              onclick="handleCellClick(this)"
              onfocus="handleCellFocus(this)" 
              ontouchstart="handleTouchStart(event)" 
              onkeydown="handleEditKeydown(event, ${i}, 'qty')">${data.qty}</td>
          <td class="editable-cell" contenteditable="true" 
              onblur="updateItem(${i}, this.innerHTML, 'rate')" 
              onclick="handleCellClick(this)"
              onfocus="handleCellFocus(this)" 
              ontouchstart="handleTouchStart(event)" 
              onkeydown="handleEditKeydown(event, ${i}, 'rate')">${data.rate}</td>
          <td>${amount}</td>
          <td><button class="delete-btn" onclick="deleteItem(${i})" aria-label="Delete Item">×</button></td>
        `;
        tbody.appendChild(row);
      });
    }
    
    document.getElementById("totalAmount").innerText = total.toFixed(2);
  }

  // 4) Keyboard Fix Functions
  let currentActiveCell = null;

  function handleTouchStart(event) {
      // Prevent the default touch action to minimize unnecessary blur/hide events
      event.preventDefault(); 
      event.currentTarget.focus(); // Force focus
      handleCellClick(event.currentTarget); // Ensure cursor is placed correctly
  }

  function handleCellFocus(element) {
      currentActiveCell = element;
  }

  function handleCellClick(element) {
      // Use a slight delay to ensure the browser registers the focus and cursor placement
      setTimeout(() => {
          if (element.textContent.length > 0) {
              const range = document.createRange();
              const selection = window.getSelection();
              
              if (element.childNodes.length > 0) {
                  let lastNode = element.childNodes[element.childNodes.length - 1];
                  range.setStart(lastNode, lastNode.textContent.length);
                  range.collapse(true);
                  selection.removeAllRanges();
                  selection.addRange(range);
              }
          }
          currentActiveCell = element;
      }, 50); 
  }

  // Handle Enter key in edit mode: Move to next column
  function handleEditKeydown(event, index, field) {
    if (event.key === "Enter") {
      event.preventDefault(); 
      const currentRow = event.target.closest('tr');
      const cells = Array.from(currentRow.querySelectorAll('.editable-cell'));
      const currentIndex = cells.indexOf(event.target);
      const nextIndex = (currentIndex + 1) % cells.length;
      
      cells[nextIndex].focus(); 
      handleCellClick(cells[nextIndex]); // Ensure cursor is placed correctly on focus
    }
  }

  function updateItem(i, htmlValue, field) {
    const value = htmlValue.trim();

    if (field !== "item") {
      // Clean up HTML tags (like accidental <div> or <br>) for number fields
      const textValue = value.replace(/<[^>]*>?/gm, '').trim();

      if (isNaN(parseFloat(textValue)) && textValue !== "-") {
        alert("Only numbers allowed for quantity and rate!");
        render(); 
        return;
      }
      list[i][field] = sanitizeInput(textValue);
    } else {
        list[i][field] = sanitizeInput(value);
    }
    
    currentActiveCell = null;
    save();
  }

  function toggle(i) { 
    list[i].done = !list[i].done; 
    save(); 
  }

  function deleteItem(i) {
    if (confirm("Are you sure you want to delete this item?")) {
      list.splice(i, 1);
      save();
    }
  }

  function clearAll() { 
    if (confirm("Are you sure you want to clear the entire list?")) {
      list = []; 
      save(); 
    }
  }

  function exportCSV() {
    if (list.length === 0) {
      alert("Your shopping list is empty. Add some items before exporting.");
      return;
    }
    
    let csv = "Item,Qty,Rate,Amount,Status\n";
    list.forEach(a => {
      const numQty = parseFloat(a.qty);
      const numRate = parseFloat(a.rate);
      const amount = (isNaN(numQty) || isNaN(numRate)) 
        ? "-" 
        : (numQty * numRate).toFixed(2);
      const status = a.done ? "Purchased" : "Pending";
      const itemEscaped = `"${a.item.replace(/"/g, '""')}"`; 
      csv += `${itemEscaped},${a.qty},${a.rate},${amount},${status}\n`;
    });
    
    let link = document.createElement("a");
    link.href = "data:text/csv;charset=utf-8," + encodeURI(csv);
    link.download = "StarShopList_" + new Date().toISOString().slice(0, 10) + ".csv";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  }

  function shareList() {
    if (list.length === 0) {
      alert("Your shopping list is empty. Add some items before sharing.");
      return;
    }
    
    if (navigator.share) {
      const listText = "My Shopping List:\n" + 
        list.map((a, i) => {
            const numQty = parseFloat(a.qty);
            const numRate = parseFloat(a.rate);
            const itemText = a.item.replace(/<br>/g, ' | '); 
            return `${i+1}. ${itemText}${!isNaN(numQty) ? ` (Qty: ${a.qty})` : ""}${!isNaN(numRate) ? ` @ ₹${a.rate}` : ""}${a.done ? " ✓" : ""}`
        }).join("\n") +
        `\n\nTotal: ₹${document.getElementById("totalAmount").innerText}`;
      
      navigator.share({
        title: 'My Shopping List',
        text: listText
      })
      .catch(err => console.log('Error sharing:', err));
    } else {
      alert("Sharing is not supported on this browser. You can take a screenshot or export as CSV to share.");
    }
  }

  // Initialize the app
  render();
</script>

</body>
</html>
